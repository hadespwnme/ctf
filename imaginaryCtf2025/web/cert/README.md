# ImaginaryCTF 2025: Certificate Generator Write-up

This write-up explains how to solve the "Certificate Generator" challenge from ImaginaryCTF 2025. The goal is to find the flag associated with the user "Eth007".

## 1. Initial Analysis

The challenge provides a URL to a certificate generator: `https://eth007.me/cert/`.

First, I inspected the source code of the web page. The core logic is implemented in JavaScript within the HTML file.

## 2. Identifying the Vulnerability

The vulnerability lies in a client-side check within the `renderPreview` JavaScript function. This function is responsible for generating the certificate preview.

```javascript
function renderPreview(){
  var name = nameInput.value.trim();
  if (name == "Eth007") {
    name = "REDACTED"
  }
  const svg = buildCertificateSVG({
    participant: name || "Participant Name",
    affiliation: affInput.value.trim() || "Participant",
    date: dateInput.value,
    styleKey: styleSelect.value
  });
  svgHolder.innerHTML = svg;
  svgHolder.dataset.currentSvg = svg;
}
```

As you can see, the code explicitly checks if the input name is "Eth007". If it is, the name is replaced with "REDACTED" before the certificate is generated. This prevents us from generating a certificate for "Eth007" through the web interface directly.

The flag itself is generated by the `makeFlag` function, which uses a `customHash` function. The result is embedded in the `<desc>` tag of the generated SVG.

```javascript
function customHash(str){
  let h = 1337;
  for (let i=0;i<str.length;i++){
    h = (h * 31 + str.charCodeAt(i)) ^ (h >>> 7);
    h = h >>> 0; // force unsigned
  }
  return h.toString(16);
}

function makeFlag(name){
  const clean = name.trim() || "anon";
  const h = customHash(clean);
  return `ictf{${h}}`;
}
```

## 3. Exploitation

Since the check is purely on the client side, we can bypass it by replicating the hashing and flag generation logic locally. I created a Python script to do this.

Here is the Python code that mimics the `customHash` and `makeFlag` functions:

```python
def custom_hash(s):
    h = 1337
    for char in s:
        h = (h * 31 + ord(char)) ^ (h >> 7)
        h = h & 0xFFFFFFFF  # force unsigned 32-bit
    return hex(h)[2:]

def make_flag(name):
    clean_name = name.strip() or "anon"
    h = custom_hash(clean_name)
    return f"ictf{{{h}}}"

print(make_flag("Eth007"))
```

Running this script with the input "Eth007" gives us the flag.

```sh
python3 solve.py
```

## 4. The Flag

The output of the script is the flag:

**`ictf{7b4b3965}`**
